# Bulk RNA-seq Analysis Pipeline

## Introduction

Bulk RNA sequencing (RNA-seq) is a widely used technique to quantify gene expression across different biological conditions. A standard bulk RNA-seq analysis involves multiple sequential steps, including quality control, read preprocessing, alignment to a reference genome, quantification of gene expression, statistical testing for differential expression, and downstream functional interpretation.

This repository contains a **manual, script-based bulk RNA-seq analysis pipeline** developed and executed locally on a Linux (Ubuntu) system. The pipeline was implemented using Bash, Python, and R scripts, following commonly accepted best practices in transcriptomics analysis.

The overall workflow and dataset selection were inspired by the publicly available repository  
**https://github.com/erilu/bulk-rnaseq-analysis**, and the **same RNA-seq samples** were used for learning and reproducibility purposes.  
However, all scripts were **independently written, executed, and modified**, and the pipeline was run end-to-end on a personal laptop environment.

---

## Dataset Description

The RNA-seq dataset used in this analysis was generated by **[Guo et al., Nature Communications (2019)](https://pubmed.ncbi.nlm.nih.gov/30655535/)** and is publicly available through the **NCBI Gene Expression Omnibus (GEO)** under the accession number **GSE106305**.

The study investigates transcriptional responses to **hypoxia** in prostate cancer cell lines. Raw sequencing data for each sample is stored in the **NCBI Sequence Read Archive (SRA)** and can be accessed via the GEO accession page:

- GEO Accession: **GSE106305**  
- GEO Link: https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE106305

---

## Experimental Design

The goal of this analysis is to identify **differentially expressed genes (DEGs) in response to hypoxia** in two prostate cancer cell lines:

- **LNCaP**
- **PC3**

For each cell line, control samples were selected under:
- **Normoxia**
- **Hypoxia**

Only control conditions were analyzed:
- *Empty_Vector* for LNCaP
- *siCtrl* for PC3

Each condition includes biological replicates.

---

## Selected Samples

| Sample Name | GSM ID | SRX ID | SRA Runs (Downloaded) |
|------------|--------|--------|------------------------|
| LNCaP_RNA-Seq_Empty_Vector_Normoxia_rep1 | GSM3145509 | SRX4096735 | SRR7179504, SRR7179505, SRR7179506, SRR7179507 |
| LNCaP_RNA-Seq_Empty_Vector_Normoxia_rep2 | GSM3145510 | SRX4096736 | SRR7179508, SRR7179509, SRR7179510, SRR7179511 |
| LNCaP_RNA-Seq_Empty_Vector_Hypoxia_rep1 | GSM3145513 | SRX4096739 | SRR7179520, SRR7179521, SRR7179522, SRR7179523 |
| LNCaP_RNA-Seq_Empty_Vector_Hypoxia_rep2 | GSM3145514 | SRX4096740 | SRR7179524, SRR7179525, SRR7179526, SRR7179527 |
| PC3_RNA-Seq_siCtrl_Normoxia_rep1 | GSM3145517 | SRX4096743 | SRR7179536 |
| PC3_RNA-Seq_siCtrl_Normoxia_rep2 | GSM3145518 | SRX4096744 | SRR7179537 |
| PC3_RNA-Seq_siCtrl_Hypoxia_rep1 | GSM3145521 | SRX4096747 | SRR7179540 |
| PC3_RNA-Seq_siCtrl_Hypoxia_rep2 | GSM3145522 | SRX4096748 | SRR7179541 |

---

## Data Retrieval and Format

Raw sequencing data were downloaded as **SRA files** from NCBI.  
Each SRA run was converted into **FASTQ format**, which is required for downstream bulk RNA-seq analysis.

The FASTQ files generated from these SRA runs serve as the starting point for:
- Quality control
- Read trimming
- Alignment
- Quantification
- Differential expression analysis

---

## Analysis Workflow

The pipeline follows a standard bulk RNA-seq analysis workflow:

1. Download RNA-seq FASTQ files
2. Perform quality control on raw reads
3. Trim adapters and low-quality bases
4. Align reads to the reference genome
5. Process and sort alignment files
6. Generate gene-level count matrices
7. Perform differential expression analysis
8. Conduct functional enrichment analysis

---

## Computing Environment

- Operating System: Linux (Ubuntu)
- Execution Platform: Local laptop
- Environment Management: Conda

This pipeline was executed **without workflow automation or containerization**, with each step run sequentially using custom scripts.

---

## Tools and Software

### Programming Languages
- Bash
- Python
- R

### Bioinformatics Tools
- FastQC – read-level quality control
- MultiQC – aggregation of QC reports
- Trimmomatic – adapter and quality trimming
- HISAT2 – read alignment
- samtools – BAM file processing
- featureCounts – gene-level quantification
- DESeq2 – differential expression analysis
- clusterProfiler – functional enrichment analysis

---

## Repository Structure
```text
├── scripts
│ ├── download_rnaseq.py
│ ├── fastq_conversion.py
│ ├── align_samples.sh
│ ├── featurecounts.sh
│ └── DESeq2_analysis.r
│
├── data
│ ├── raw_fastq
│ ├── trimmed_fastq
│ └── reference
│
├── results
│ ├── qc
│ ├── alignment
│ ├── counts
│ ├── differential_expression
│ └── enrichment
│
└── README.md
```
---

## Quality Control and Preprocessing

Raw FASTQ files were assessed using **FastQC** to evaluate sequencing quality, GC content, adapter contamination, and other metrics.  
**MultiQC** was used to aggregate QC reports across all samples.

Reads were trimmed using **Trimmomatic** to remove sequencing adapters and low-quality bases prior to alignment.

---

## Read Alignment

Trimmed reads were aligned to the reference genome using **HISAT2**, a splice-aware aligner optimized for RNA-seq data.  
Aligned reads were processed using **samtools** to generate sorted BAM files suitable for downstream analysis.

---

## Gene Expression Quantification

Gene-level read counts were generated using **featureCounts**, based on the provided gene annotation (GTF file).  
The resulting count matrix was used as input for differential expression analysis.

---

## Differential Expression Analysis

Differential gene expression analysis was performed in **R** using the **DESeq2** package.  
The analysis included:
- Normalization of read counts
- Estimation of dispersion
- Statistical testing using the Wald test
- Multiple testing correction using the Benjamini–Hochberg method

Significantly differentially expressed genes were identified based on adjusted p-values and log2 fold-change thresholds.

---

## Functional Enrichment Analysis

Functional interpretation of differentially expressed genes was performed using **clusterProfiler**.  
Gene Ontology (GO) and pathway enrichment analyses were conducted to identify overrepresented biological processes and pathways.

---

## Limitations

- Pipeline execution is manual and sequential
- No workflow manager (Nextflow / Snakemake) is used
- No containerization (Docker / Singularity)
- Not optimized for large-scale or HPC environments

---

## Future Improvements

- Automating the workflow using a workflow management system
- Containerizing the pipeline for reproducibility
- Adding logging, configuration files, and parameterization
- Scaling execution to HPC or cloud platforms

---

## Acknowledgements

This work was inspired by the following repository:

- https://github.com/erilu/bulk-rnaseq-analysis

The dataset and general workflow structure were adopted for learning and reproducibility, while the implementation and execution were performed independently.

---

## Author

**Prashant Phulpagar**  
PhD – Genomics & Neurogenetics  
Bulk RNA-seq Analysis | Bioinformatics | NGS Data Analysis




